<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Haunted Roast Bot ðŸ‘»</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="flex flex-col items-center justify-center h-screen">
    <div class="max-w-lg w-full bg-black/70 p-6 rounded-2xl shadow-2xl border border-red-900">
      <h1 id="ghostName" class="text-2xl font-bold glitch text-red-500 text-center mb-4">
        ðŸ‘» Connecting to the other side...
      </h1>

      <div id="chatBox" class="h-80 overflow-y-auto bg-black/50 p-3 rounded-lg border border-gray-700 mb-4"></div>

      <div class="flex gap-2">
        <input
          id="userInput"
          type="text"
          placeholder="Say something..."
          class="flex-1 p-2 rounded-lg bg-gray-900 border border-gray-600 text-white"
        />
        <button
          onclick="sendMessage()"
          class="px-4 py-2 bg-red-600 hover:bg-red-800 rounded-lg"
        >
          Send
        </button>
      </div>
    </div>

    <script>
      const API_BASE = "http://localhost:8080";
      let ghost = "";

      async function initGhost() {
        const res = await fetch(`${API_BASE}/ghost`);
        const data = await res.json();
        ghost = data.ghost;
        document.getElementById("ghostName").innerText = `ðŸ’€ You are speaking with: ${ghost}`;
      }

      function appendMessage(sender, text) {
        const chatBox = document.getElementById("chatBox");
        const div = document.createElement("div");
        div.className = sender === "you" ? "text-right mb-2" : "text-left mb-2";
        div.innerHTML = `<span class="message ${
          sender === "ghost" ? "text-red-400" : "text-gray-200"
        }"><b>${sender}:</b> ${text}</span>`;
        chatBox.appendChild(div);
        chatBox.scrollTop = chatBox.scrollHeight;
      }

      async function sendMessage() {
  const input = document.getElementById("userInput");
  const msg = input.value.trim();
  if (!msg) return;
  appendMessage("you", msg);
  input.value = "";

  const res = await fetch(`${API_BASE}/chat`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ message: msg }),
  });

  const data = await res.json();
  appendMessage(ghost, data.reply); 
}


      initGhost();
    </script>
  </body>
</html>
